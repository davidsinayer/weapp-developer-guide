# WeGene 微解读专业版（轻应用）发布文档 #

### 版本：0.2 ###

---

完成轻应用的开发以后，开发者可以将应用打包并发布到 WeGene 的平台上。以下是整个发布过程的流程——

![轻应用发布流程图](image/weapp-release-process.png)

在上传过程中，一个轻应用可能有以下状态：

| 应用状态 | 说明 | 编辑状态 | 用户可见性 |
|:-----:|:----:|:----:|:----:|
| 构建中 | 代码已经上传，正在构建中 | 不可编辑 | 不可见 |
| 构建失败 | 应用在构建过程中发生错误，需要重新打包构建 | 可重新编辑 | 不可见 |
| 构建成功 | 应用已经构建成功，等待应用测试 | 可重新编辑 | 不可见 |
| 测试失败 | 应用在接受测试数据运行后发生错误 | 可重新编辑 | 不可见 |
| 测试成功 | 应用在接受测试数据运行后成功，可以发布 | 可重新编辑 | 不可见 |
| 审核中 | 应用在管理员审核过程中 | 不可编辑 | 开发者及管理员可见 |
| 上线 | 应用通过审核，成功上线 | 可重新编辑 | 所有用户可见 |


**在完成上线后，开发者仍可以重新编辑应用，更新代码。如果代码被更新，需要重新进入从构建开始的一系列发布过程。如果开发者只想修改应用的文本说明，在编辑时可以选择不上传新的代码文件，这样后端会跳过构建及应用更新步骤。**

---

**下面是发布各步骤的详细说明：**

#### 0. 打包你的代码 ####

完成轻应用的开发后（参照[开发者指南](https://github.com/wegene-llc/weapp-developer-guide/blob/master/docs/weapp-developer-guide.md)），开发者首先需要将代码打包。假设你的工程文件夹结构如下——

```
your_weapp_project_folder
├── main.py （主计算脚本）
├── requirements.txt （你的脚本需要的第三方依赖包定义文件）
└── your_utils.py （你的其他依赖代码）
```

将以上三个文件全选打包成`.zip`格式的文件，**注意不要将上级目录`your_weapp_project_folder`打包，即你的`main.py`和`requirements.txt`文件必须在 zip 文件的根目录下。**

#### 1. 上传代码 ####

完成工程的打包以后，你可以进入 WeGene 的[微解读](https://www.wegene.com/crowdsourcing/)页面。测试阶段，已经通过申请的开发者可以在界面上看到`创建专业版`按钮。点击进入开始上传代码。

在这里，首先你需要为你的轻应用填写相应的名字、简介、封面图片（360*240）、你的应用开发所使用的语言以及所需的入参。如果你需要部分位点作为入参，你可以在选择`部分位点`作为入参后在下方的输入框中依次输入，也可以点击`批量添加`，在弹出的输入框中批量复制添加。

最后，选择上传你的打包工程文件，点击下一步。

![上传代码界面](image/step1.png)
![批量添加位点](image/step2.png)

#### 2. 构建应用 ####

完成代码上传后，你会进入代码构建页面。在这里，WeGene 会自动处理你的代码的构建与部署，开发者无需进行任何操作。通常，构建会在 30 分钟内完成并通知开发者构建的结果。如果构建过程中遇到任何问题（如没有必须的主计算脚本等），我们会将构建的错误日志输出以供你在重新编辑时修改。如果构建成功，你可以进入下一步测试应用。在整个构建等待中，你可以随时关闭页面，并从微解读“我发起的”界面中进入查看。

![构建错误界面](image/step3.png)

#### 3. 测试应用 ####

应用构建成功表示工程没有配置上的错误，但在应用执行过程中仍有可能遇到程序逻辑错误。因此，我们要求每个应用在发布前必须通过测试。在测试界面中，点击`开始测试`按钮进行测试。此时，我们会根据应用申请的输入参数，向应用发送测试数据。只有成功运行，未返回错误信息的应用才可以进入下一步发布。如果在此过程中应用返回了任何错误，你需要修改你的工程后重新构建应用并测试。**请注意，测试时使用的输入数据是测试数据，而非应用开发者本人的数据。**

![测试界面](image/step4.png)
![通过测试界面](image/step5.png)

#### 4. 发布应用 ####

通过测试的应用可以被发布。点击`发布应用`后，需要等待管理员审核通过，应用方可上架。在等待审核期间，开发者本人可以从微解读“我发起的”界面进入应用并测试。如果管理员审核不通过，则开发者需要根据管理员的反馈进行相应修改后再次发布。

![发布界面](image/step6.png)
